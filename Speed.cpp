#include "sys_param.h"
void Speed(Doub kx, Doub V_p[N_Com][N_En_Pr], complex<Doub> H[N_LAT][N_LAT][N_Band][N_Band], Doub r[N_LAT][3][3])
{
	complex<Doub> CI(0.0, 1.0);
	Doub V1[14],V2[14],V3[14],V4[14],V5[14];
	Doub V[N_Band];
	Doub a,b,c,d,Pi,x,y,z,a1,a2,a3,a4,a5;
	a = 3.0;         //����� ������������ ������
	Pi = 3.1415926536;
	b = 0.0;
	c = 0.0;
	d = 0.0;
	a1 = 1.0;          //���������� ����� ���������� �������� (1 �����. ��.)
	a2 = 1.5;		  //2 �����. ��.
	a3 = 1.732;	  //3 �����. ��.
	a4 = 1.8027;	  //4 �����. ��.
	a5 = 2.0;		  //5 �����. ��.
	for(int i = 0; i < N_En_Pr; i++)
	{
		if ((i >= 0) && (i < 4)){ V[i]=V_p[0][i];}
		if ((i >= 4) && (i < 18)){ V1[i-4]=V_p[0][i];}
		if ((i >= 18) && (i < 32)){ V2[i-18]=V_p[0][i];}
		if ((i >= 32) && (i < 46)){ V3[i-32]=V_p[0][i];}
		if ((i >= 46) && (i < 60)){ V4[i-46]=V_p[0][i];}
		if ((i >= 60) && (i < 74)){ V5[i-60]=V_p[0][i];}
	}
	for (int i = 0; i < N_LAT; i++)
	{
		for (int j = 0; j < N_LAT; j++)
		{
			for (int n = 0; n < 3; n++)
			{
				x = (r[j][0][n] - r[i][0][1]);
				y = (r[j][1][n] - r[i][1][1]);
				z = (r[j][2][n] - r[i][2][1]);
				d = sqrt(x*x + y*y + z*z);
				if ((d > a1 - 0.001) && (d < a1 + 0.001))
				{
					H[i][j][0][0] = H[i][j][0][0] + V1[0]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][1] = H[i][j][0][1] + (x/d)*V1[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][2] = H[i][j][0][2] + (y/d)*V1[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][3] = H[i][j][0][3] + (z/d)*V1[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][4] = H[i][j][0][4] + 1.732*(x/d)*(y/d)*V1[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][5] = H[i][j][0][5] + 1.732*(y/d)*(z/d)*V1[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][6] = H[i][j][0][6] + 1.732*(z/d)*(x/d)*V1[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][7] = H[i][j][0][7] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V1[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][8] = H[i][j][0][8] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][9] = H[i][j][0][9] + V1[10]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][0] = H[i][j][1][0] - (x/d)*V1[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][1] = H[i][j][1][1] + ((x/d)*(x/d)*V1[1] + (1-(x/d)*(x/d))*V1[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][2] = H[i][j][1][2] + (x/d)*(y/d)*(V1[1] - V1[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][3] = H[i][j][1][3] + (x/d)*(z/d)*(V1[1] - V1[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][4] = H[i][j][1][4] + (1.732*(x/d)*(x/d)*(y/d)*V1[8]+(y/d)*(1-2*(x/d)*(x/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][5] = H[i][j][1][5] + (x/d)*(y/d)*(z/d)*(1.732*V1[8]-2.0*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][6] = H[i][j][1][6] + (1.732*(x/d)*(x/d)*(z/d)*V1[8]+(z/d)*(1-2*(x/d)*(x/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][7] = H[i][j][1][7] + (0.5*1.732*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[8]+
						(x/d)*(1-(x/d)*(x/d)+ (y/d)*(y/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][8] = H[i][j][1][8] + (x/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[8]
						-1.732*(x/d)*(z/d)*(z/d)*V1[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][9] = H[i][j][1][9] - (x/d)*V1[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][0] = H[i][j][2][0] - (y/d)*V1[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][1] = H[i][j][2][1] + (x/d)*(y/d)*(V1[1] - V1[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][2] = H[i][j][2][2] + ((y/d)*(y/d)*V1[1] + (1-(y/d)*(y/d))*V1[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][3] = H[i][j][2][3] + (y/d)*(z/d)*(V1[1] - V1[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][4] = H[i][j][2][4] + (1.732*(y/d)*(y/d)*(x/d)*V1[8]+(x/d)*(1-2*(y/d)*(y/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][5] = H[i][j][2][5] + (1.732*(y/d)*(y/d)*(z/d)*V1[8]+(z/d)*(1-2*(y/d)*(y/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][6] = H[i][j][2][6] + (y/d)*(z/d)*(x/d)*(1.732*V1[8]-2.0*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][7] = H[i][j][2][7] + 0.5*1.732*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[8]-
						(y/d)*(1+(x/d)*(x/d)-(y/d)*(y/d))*V1[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][8] = H[i][j][2][8] + (y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[8]-
						1.732*(y/d)*(z/d)*(z/d)*V1[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][9] = H[i][j][2][9] - (y/d)*V1[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][0] = H[i][j][3][1] - (z/d)*V1[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][1] = H[i][j][3][1] + (x/d)*(z/d)*(V1[1] - V1[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][2] = H[i][j][3][2] + (y/d)*(z/d)*(V1[1] - V1[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][3] = H[i][j][3][3] + ((z/d)*(z/d)*V1[1] + (1-(z/d)*(z/d))*V1[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][4] = H[i][j][3][4] + (x/d)*(y/d)*(z/d)*(1.732*V1[8]-2.0*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][5] = H[i][j][3][5] + (1.732*(z/d)*(z/d)*(y/d)*V1[8]+(y/d)*(1-2*(z/d)*(z/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][6] = H[i][j][3][6] + (1.732*(z/d)*(z/d)*(x/d)*V1[8]+(x/d)*(1-2*(z/d)*(z/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][7] = H[i][j][3][7] + (0.5*1.732*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[8]-
						(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][8] = H[i][j][3][8] + ((z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[8]+
						1.732*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][9] = H[i][j][3][9] - (z/d)*V1[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][0] = H[i][j][4][0] + 1.732*(x/d)*(y/d)*V1[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][1] = H[i][j][4][1] - (1.732*(x/d)*(x/d)*(y/d)*V1[8]+(y/d)*(1-2.0*(x/d)*(x/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][2] = H[i][j][4][2] - (1.732*(y/d)*(y/d)*(x/d)*V1[8]+(x/d)*(1-2.0*(y/d)*(y/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][3] = H[i][j][4][3] - (x/d)*(y/d)*(z/d)*(1.732*V1[8]-2.0*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][4] = H[i][j][4][4] + (3.0*(x/d)*(x/d)*(y/d)*(y/d)*V1[3]+((x/d)*(x/d)+(y/d)*(y/d)-4.0*(x/d)*(x/d)*(y/d)*(y/d))*V1[4]+
						((z/d)*(z/d)+(x/d)*(x/d)*(y/d)*(y/d))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][5] = H[i][j][4][5] + (3.0*(x/d)*(y/d)*(y/d)*(z/d)*V1[3]+(x/d)*(z/d)*(1-4*(y/d)*(y/d))*V1[4]+
						(x/d)*(z/d)*((y/d)*(y/d)-1)*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][6] = H[i][j][4][6] + (3*(x/d)*(x/d)*(y/d)*(z/d)*V1[3]+(y/d)*(z/d)*(1-4.0*(x/d)*(x/d))*V1[4]+
						(y/d)*(z/d)*((x/d)*(x/d)-1)*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][7] = H[i][j][4][7] + (1.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[3]+2.0*(x/d)*(y/d)*((y/d)*(y/d)-(x/d)*(x/d))*V1[4]+
						0.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][8] = H[i][j][4][8] + (1.732*(x/d)*(y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[3]+
						2.0*1.732*(x/d)*(y/d)*(z/d)*(z/d)*V1[4]+0.5*1.732*(x/d)*(y/d)*(1+(z/d)*(z/d))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][9] = H[i][j][4][9] + 1.732*(x/d)*(y/d)*V1[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][0] = H[i][j][5][0] + 1.732*(y/d)*(z/d)*V1[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][1] = H[i][j][5][1] - (x/d)*(y/d)*(z/d)*(1.732*V1[8]-2.0*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][2] = H[i][j][5][2] - (1.732*(y/d)*(y/d)*(z/d)*V1[8]+(z/d)*(1-2*(y/d)*(y/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][3] = H[i][j][5][3] - (1.732*(z/d)*(z/d)*(y/d)*V1[8]+(y/d)*(1-2*(z/d)*(z/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][4] = H[i][j][5][4] - (3.0*(x/d)*(y/d)*(y/d)*(z/d)*V1[3]+(x/d)*(z/d)*(1-4*(y/d)*(y/d))*V1[4]+
						(x/d)*(z/d)*((y/d)*(y/d)-1)*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][5] = H[i][j][5][5] + (3.0*(y/d)*(y/d)*(z/d)*(z/d)*V1[3]+((y/d)*(y/d)+(z/d)*(z/d)-4.0*(y/d)*(y/d)*(z/d)*(z/d))*V1[4]+
						((x/d)*(x/d)+(y/d)*(y/d)*(z/d)*(z/d))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][6] = H[i][j][5][6] + (3.0*(y/d)*(z/d)*(z/d)*(x/d)*V1[3]+(y/d)*(x/d)*(1-4*(z/d)*(z/d))*V1[4]+
						(y/d)*(x/d)*((z/d)*(z/d)-1)*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][7] = H[i][j][5][7] + (1.5*(y/d)*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[3]-
						(y/d)*(z/d)*(1+2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V1[4]+
						(y/d)*(z/d)*(1.0+0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][8] = H[i][j][5][8] + (1.732*(y/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[3]+
						1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V1[4]-
						0.5*1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][9] = H[i][j][5][9] + (1.732*(y/d)*(z/d)*V1[7])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][0] = H[i][j][6][0] + 1.732*(z/d)*(x/d)*V1[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][1] = H[i][j][6][1] - (1.732*(x/d)*(x/d)*(z/d)*V1[8]+(z/d)*(1-2*(x/d)*(x/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][2] = H[i][j][6][2] - (y/d)*(z/d)*(x/d)*(1.732*V1[8]-2.0*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][3] = H[i][j][6][3] - (1.732*(z/d)*(z/d)*(x/d)*V1[8]+(x/d)*(1-2*(z/d)*(z/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][4] = H[i][j][6][4] + (3*(x/d)*(x/d)*(y/d)*(z/d)*V1[3]+(y/d)*(z/d)*(1-4.0*(x/d)*(x/d))*V1[4]+
						(y/d)*(z/d)*((x/d)*(x/d)-1)*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][5] = H[i][j][6][5] + (3.0*(y/d)*(z/d)*(z/d)*(x/d)*V1[3]+(y/d)*(x/d)*(1-4*(z/d)*(z/d))*V1[4]+
						(y/d)*(x/d)*((z/d)*(z/d)-1)*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][6] = H[i][j][6][6] + (3.0*(z/d)*(z/d)*(x/d)*(x/d)*V1[3]+((z/d)*(z/d)+(x/d)*(x/d)-4.0*(z/d)*(z/d)*(x/d)*(x/d))*V1[4]+
						((y/d)*(y/d)+(z/d)*(z/d)*(x/d)*(x/d))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][7] = H[i][j][6][7] + (1.5*(z/d)*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[3]+
						(z/d)*(x/d)*(1.0-2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V1[4]-
						(z/d)*(x/d)*(1.0-0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][8] = H[i][j][6][8] + (1.732*(x/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[3]+
						1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V1[4]-
						0.5*1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][9] = H[i][j][6][9] + 1.732*(z/d)*(x/d)*V1[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][0] = H[i][j][7][0] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V1[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][1] = H[i][j][7][1] - (0.5*1.732*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[8]+
						(x/d)*(1-(x/d)*(x/d) + (y/d)*(y/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][2] = H[i][j][7][2] - 0.5*1.732*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[8]-
						(y/d)*(1+(x/d)*(x/d)-(y/d)*(y/d))*V1[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][3] = H[i][j][7][3] - (0.5*1.732*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[8]-
						(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][4] = H[i][j][7][4] + (1.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[3]+2.0*(x/d)*(y/d)*((y/d)*(y/d)-(x/d)*(x/d))*V1[4]+
						0.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][5] = H[i][j][7][5] + (1.5*(y/d)*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[3]-
						(y/d)*(z/d)*(1+2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V1[4]+
						(y/d)*(z/d)*(1.0+0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][6] = H[i][j][7][6] + (1.5*(z/d)*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V1[3]+
						(z/d)*(x/d)*(1.0-2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V1[4]-
						(z/d)*(x/d)*(1.0-0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][7] = H[i][j][7][7] + (0.75*((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d))*V1[3]+
						((x/d)*(x/d)+(y/d)*(y/d)-((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d)))*V1[4]+
						((z/d)*(z/d)+0.25*((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d)))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][8] = H[i][j][7][8] + (0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[3]+
						1.732*(z/d)*(z/d)*((y/d)*(y/d)-(x/d)*(x/d))*V1[4]+
						0.25*1.732*(1+(z/d)*(z/d))*((x/d)*(x/d)-(y/d)*(y/d))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][9] = H[i][j][7][9] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V1[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][0] = H[i][j][8][0] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][1] = H[i][j][8][1] - (x/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[8]
						-1.732*(x/d)*(z/d)*(z/d)*V1[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][2] = H[i][j][8][2] - (y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[8]-
						1.732*(y/d)*(z/d)*(z/d)*V1[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][3] = H[i][j][8][3] - ((z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[8]+
						1.732*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V1[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][4] = H[i][j][8][4] + (1.732*(x/d)*(y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[3]+
						2.0*1.732*(x/d)*(y/d)*(z/d)*(z/d)*V1[4]+0.5*1.732*(x/d)*(y/d)*(1+(z/d)*(z/d))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][5] = H[i][j][8][5] + (1.732*(y/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[3]+
						1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V1[4]-
						0.5*1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][6] = H[i][j][8][6] + (1.732*(x/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[3]+
						1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V1[4]-
						0.5*1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][7] = H[i][j][8][7] +  (0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[3]+
						1.732*(z/d)*(z/d)*((y/d)*(y/d)-(x/d)*(x/d))*V1[4]+
						0.25*1.732*(1+(z/d)*(z/d))*((x/d)*(x/d)-(y/d)*(y/d))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][8] = H[i][j][8][8] + (((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[3]+
						3.0*(z/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V1[4]+
						0.75*((x/d)*(x/d)+(y/d)*(y/d))*((x/d)*(x/d)+(y/d)*(y/d))*V1[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][9] = H[i][j][8][9] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][0] = H[i][j][9][0] + V1[10]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][1] = H[i][j][9][1] + (x/d)*V1[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][2] = H[i][j][9][2] + (y/d)*V1[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][3] = H[i][j][9][3] + (z/d)*V1[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][4] = H[i][j][9][4] + 1.732*(x/d)*(y/d)*V1[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][5] = H[i][j][9][5] + (1.732*(y/d)*(z/d)*V1[7])*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][6] = H[i][j][9][6] + 1.732*(z/d)*(x/d)*V1[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][7] = H[i][j][9][7] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V1[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][8] = H[i][j][9][8] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V1[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][9] = H[i][j][9][9] + V1[13]*exp(CI*kx*x)*x*2.68341;
				}
				if ((d > a2 - 0.001) && (d < a2 + 0.001))
				{
					H[i][j][0][0] = H[i][j][0][0] + V2[0]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][1] = H[i][j][0][1] + (x/d)*V2[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][2] = H[i][j][0][2] + (y/d)*V2[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][3] = H[i][j][0][3] + (z/d)*V2[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][4] = H[i][j][0][4] + 1.732*(x/d)*(y/d)*V2[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][5] = H[i][j][0][5] + 1.732*(y/d)*(z/d)*V2[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][6] = H[i][j][0][6] + 1.732*(z/d)*(x/d)*V2[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][7] = H[i][j][0][7] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V2[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][8] = H[i][j][0][8] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][9] = H[i][j][0][9] + V2[10]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][0] = H[i][j][1][0] - (x/d)*V2[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][1] = H[i][j][1][1] + ((x/d)*(x/d)*V2[1] + (1-(x/d)*(x/d))*V2[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][2] = H[i][j][1][2] + (x/d)*(y/d)*(V2[1] - V2[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][3] = H[i][j][1][3] + (x/d)*(z/d)*(V2[1] - V2[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][4] = H[i][j][1][4] + (1.732*(x/d)*(x/d)*(y/d)*V2[8]+(y/d)*(1-2*(x/d)*(x/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][5] = H[i][j][1][5] + (x/d)*(y/d)*(z/d)*(1.732*V2[8]-2.0*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][6] = H[i][j][1][6] + (1.732*(x/d)*(x/d)*(z/d)*V2[8]+(z/d)*(1-2*(x/d)*(x/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][7] = H[i][j][1][7] + (0.5*1.732*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[8]+
						(x/d)*(1-(x/d)*(x/d)+ (y/d)*(y/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][8] = H[i][j][1][8] + (x/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[8]
						-1.732*(x/d)*(z/d)*(z/d)*V2[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][9] = H[i][j][1][9] - (x/d)*V2[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][0] = H[i][j][2][0] - (y/d)*V2[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][1] = H[i][j][2][1] + (x/d)*(y/d)*(V2[1] - V2[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][2] = H[i][j][2][2] + ((y/d)*(y/d)*V2[1] + (1-(y/d)*(y/d))*V2[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][3] = H[i][j][2][3] + (y/d)*(z/d)*(V2[1] - V2[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][4] = H[i][j][2][4] + (1.732*(y/d)*(y/d)*(x/d)*V2[8]+(x/d)*(1-2*(y/d)*(y/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][5] = H[i][j][2][5] + (1.732*(y/d)*(y/d)*(z/d)*V2[8]+(z/d)*(1-2*(y/d)*(y/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][6] = H[i][j][2][6] + (y/d)*(z/d)*(x/d)*(1.732*V2[8]-2.0*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][7] = H[i][j][2][7] + 0.5*1.732*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[8]-
						(y/d)*(1+(x/d)*(x/d)-(y/d)*(y/d))*V2[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][8] = H[i][j][2][8] + (y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[8]-
						1.732*(y/d)*(z/d)*(z/d)*V2[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][9] = H[i][j][2][9] - (y/d)*V2[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][0] = H[i][j][3][1] - (z/d)*V2[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][1] = H[i][j][3][1] + (x/d)*(z/d)*(V2[1] - V2[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][2] = H[i][j][3][2] + (y/d)*(z/d)*(V2[1] - V2[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][3] = H[i][j][3][3] + ((z/d)*(z/d)*V2[1] + (1-(z/d)*(z/d))*V2[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][4] = H[i][j][3][4] + (x/d)*(y/d)*(z/d)*(1.732*V2[8]-2.0*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][5] = H[i][j][3][5] + (1.732*(z/d)*(z/d)*(y/d)*V2[8]+(y/d)*(1-2*(z/d)*(z/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][6] = H[i][j][3][6] + (1.732*(z/d)*(z/d)*(x/d)*V2[8]+(x/d)*(1-2*(z/d)*(z/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][7] = H[i][j][3][7] + (0.5*1.732*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[8]-
						(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][8] = H[i][j][3][8] + ((z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[8]+
						1.732*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][9] = H[i][j][3][9] - (z/d)*V2[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][0] = H[i][j][4][0] + 1.732*(x/d)*(y/d)*V2[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][1] = H[i][j][4][1] - (1.732*(x/d)*(x/d)*(y/d)*V2[8]+(y/d)*(1-2.0*(x/d)*(x/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][2] = H[i][j][4][2] - (1.732*(y/d)*(y/d)*(x/d)*V2[8]+(x/d)*(1-2.0*(y/d)*(y/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][3] = H[i][j][4][3] - (x/d)*(y/d)*(z/d)*(1.732*V2[8]-2.0*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][4] = H[i][j][4][4] + (3.0*(x/d)*(x/d)*(y/d)*(y/d)*V2[3]+((x/d)*(x/d)+(y/d)*(y/d)-4.0*(x/d)*(x/d)*(y/d)*(y/d))*V2[4]+
						((z/d)*(z/d)+(x/d)*(x/d)*(y/d)*(y/d))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][5] = H[i][j][4][5] + (3.0*(x/d)*(y/d)*(y/d)*(z/d)*V2[3]+(x/d)*(z/d)*(1-4*(y/d)*(y/d))*V2[4]+
						(x/d)*(z/d)*((y/d)*(y/d)-1)*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][6] = H[i][j][4][6] + (3*(x/d)*(x/d)*(y/d)*(z/d)*V2[3]+(y/d)*(z/d)*(1-4.0*(x/d)*(x/d))*V2[4]+
						(y/d)*(z/d)*((x/d)*(x/d)-1)*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][7] = H[i][j][4][7] + (1.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[3]+2.0*(x/d)*(y/d)*((y/d)*(y/d)-(x/d)*(x/d))*V2[4]+
						0.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][8] = H[i][j][4][8] + (1.732*(x/d)*(y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[3]+
						2.0*1.732*(x/d)*(y/d)*(z/d)*(z/d)*V2[4]+0.5*1.732*(x/d)*(y/d)*(1+(z/d)*(z/d))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][9] = H[i][j][4][9] + 1.732*(x/d)*(y/d)*V2[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][0] = H[i][j][5][0] + 1.732*(y/d)*(z/d)*V2[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][1] = H[i][j][5][1] - (x/d)*(y/d)*(z/d)*(1.732*V2[8]-2.0*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][2] = H[i][j][5][2] - (1.732*(y/d)*(y/d)*(z/d)*V2[8]+(z/d)*(1-2*(y/d)*(y/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][3] = H[i][j][5][3] - (1.732*(z/d)*(z/d)*(y/d)*V2[8]+(y/d)*(1-2*(z/d)*(z/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][4] = H[i][j][5][4] - (3.0*(x/d)*(y/d)*(y/d)*(z/d)*V2[3]+(x/d)*(z/d)*(1-4*(y/d)*(y/d))*V2[4]+
						(x/d)*(z/d)*((y/d)*(y/d)-1)*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][5] = H[i][j][5][5] + (3.0*(y/d)*(y/d)*(z/d)*(z/d)*V2[3]+((y/d)*(y/d)+(z/d)*(z/d)-4.0*(y/d)*(y/d)*(z/d)*(z/d))*V2[4]+
						((x/d)*(x/d)+(y/d)*(y/d)*(z/d)*(z/d))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][6] = H[i][j][5][6] + (3.0*(y/d)*(z/d)*(z/d)*(x/d)*V2[3]+(y/d)*(x/d)*(1-4*(z/d)*(z/d))*V2[4]+
						(y/d)*(x/d)*((z/d)*(z/d)-1)*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][7] = H[i][j][5][7] + (1.5*(y/d)*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[3]-
						(y/d)*(z/d)*(1+2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V2[4]+
						(y/d)*(z/d)*(1.0+0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][8] = H[i][j][5][8] + (1.732*(y/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[3]+
						1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V2[4]-
						0.5*1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][9] = H[i][j][5][9] + (1.732*(y/d)*(z/d)*V2[7])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][0] = H[i][j][6][0] + 1.732*(z/d)*(x/d)*V2[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][1] = H[i][j][6][1] - (1.732*(x/d)*(x/d)*(z/d)*V2[8]+(z/d)*(1-2*(x/d)*(x/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][2] = H[i][j][6][2] - (y/d)*(z/d)*(x/d)*(1.732*V2[8]-2.0*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][3] = H[i][j][6][3] - (1.732*(z/d)*(z/d)*(x/d)*V2[8]+(x/d)*(1-2*(z/d)*(z/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][4] = H[i][j][6][4] + (3*(x/d)*(x/d)*(y/d)*(z/d)*V2[3]+(y/d)*(z/d)*(1-4.0*(x/d)*(x/d))*V2[4]+
						(y/d)*(z/d)*((x/d)*(x/d)-1)*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][5] = H[i][j][6][5] + (3.0*(y/d)*(z/d)*(z/d)*(x/d)*V2[3]+(y/d)*(x/d)*(1-4*(z/d)*(z/d))*V2[4]+
						(y/d)*(x/d)*((z/d)*(z/d)-1)*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][6] = H[i][j][6][6] + (3.0*(z/d)*(z/d)*(x/d)*(x/d)*V2[3]+((z/d)*(z/d)+(x/d)*(x/d)-4.0*(z/d)*(z/d)*(x/d)*(x/d))*V2[4]+
						((y/d)*(y/d)+(z/d)*(z/d)*(x/d)*(x/d))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][7] = H[i][j][6][7] + (1.5*(z/d)*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[3]+
						(z/d)*(x/d)*(1.0-2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V2[4]-
						(z/d)*(x/d)*(1.0-0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][8] = H[i][j][6][8] + (1.732*(x/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[3]+
						1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V2[4]-
						0.5*1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][9] = H[i][j][6][9] + 1.732*(z/d)*(x/d)*V2[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][0] = H[i][j][7][0] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V2[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][1] = H[i][j][7][1] - (0.5*1.732*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[8]+
						(x/d)*(1-(x/d)*(x/d) + (y/d)*(y/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][2] = H[i][j][7][2] - 0.5*1.732*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[8]-
						(y/d)*(1+(x/d)*(x/d)-(y/d)*(y/d))*V2[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][3] = H[i][j][7][3] - (0.5*1.732*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[8]-
						(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][4] = H[i][j][7][4] + (1.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[3]+2.0*(x/d)*(y/d)*((y/d)*(y/d)-(x/d)*(x/d))*V2[4]+
						0.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][5] = H[i][j][7][5] + (1.5*(y/d)*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[3]-
						(y/d)*(z/d)*(1+2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V2[4]+
						(y/d)*(z/d)*(1.0+0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][6] = H[i][j][7][6] + (1.5*(z/d)*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V2[3]+
						(z/d)*(x/d)*(1.0-2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V2[4]-
						(z/d)*(x/d)*(1.0-0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][7] = H[i][j][7][7] + (0.75*((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d))*V2[3]+
						((x/d)*(x/d)+(y/d)*(y/d)-((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d)))*V2[4]+
						((z/d)*(z/d)+0.25*((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d)))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][8] = H[i][j][7][8] + (0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[3]+
						1.732*(z/d)*(z/d)*((y/d)*(y/d)-(x/d)*(x/d))*V2[4]+
						0.25*1.732*(1+(z/d)*(z/d))*((x/d)*(x/d)-(y/d)*(y/d))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][9] = H[i][j][7][9] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V2[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][0] = H[i][j][8][0] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][1] = H[i][j][8][1] - (x/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[8]
						-1.732*(x/d)*(z/d)*(z/d)*V2[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][2] = H[i][j][8][2] - (y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[8]-
						1.732*(y/d)*(z/d)*(z/d)*V2[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][3] = H[i][j][8][3] - ((z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[8]+
						1.732*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V2[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][4] = H[i][j][8][4] + (1.732*(x/d)*(y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[3]+
						2.0*1.732*(x/d)*(y/d)*(z/d)*(z/d)*V2[4]+0.5*1.732*(x/d)*(y/d)*(1+(z/d)*(z/d))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][5] = H[i][j][8][5] + (1.732*(y/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[3]+
						1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V2[4]-
						0.5*1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][6] = H[i][j][8][6] + (1.732*(x/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[3]+
						1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V2[4]-
						0.5*1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][7] = H[i][j][8][7] +  (0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[3]+
						1.732*(z/d)*(z/d)*((y/d)*(y/d)-(x/d)*(x/d))*V2[4]+
						0.25*1.732*(1+(z/d)*(z/d))*((x/d)*(x/d)-(y/d)*(y/d))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][8] = H[i][j][8][8] + (((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[3]+
						3.0*(z/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V2[4]+
						0.75*((x/d)*(x/d)+(y/d)*(y/d))*((x/d)*(x/d)+(y/d)*(y/d))*V2[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][9] = H[i][j][8][9] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][0] = H[i][j][9][0] + V2[10]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][1] = H[i][j][9][1] + (x/d)*V2[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][2] = H[i][j][9][2] + (y/d)*V2[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][3] = H[i][j][9][3] + (z/d)*V2[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][4] = H[i][j][9][4] + 1.732*(x/d)*(y/d)*V2[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][5] = H[i][j][9][5] + (1.732*(y/d)*(z/d)*V2[7])*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][6] = H[i][j][9][6] + 1.732*(z/d)*(x/d)*V2[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][7] = H[i][j][9][7] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V2[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][8] = H[i][j][9][8] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V2[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][9] = H[i][j][9][9] + V2[13]*exp(CI*kx*x)*x*2.68341;
				}
				if ((d > a3 - 0.001) && (d < a3 + 0.001))
				{
					H[i][j][0][0] = H[i][j][0][0] + V3[0]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][1] = H[i][j][0][1] + (x/d)*V3[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][2] = H[i][j][0][2] + (y/d)*V3[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][3] = H[i][j][0][3] + (z/d)*V3[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][4] = H[i][j][0][4] + 1.732*(x/d)*(y/d)*V3[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][5] = H[i][j][0][5] + 1.732*(y/d)*(z/d)*V3[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][6] = H[i][j][0][6] + 1.732*(z/d)*(x/d)*V3[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][7] = H[i][j][0][7] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V3[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][8] = H[i][j][0][8] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][9] = H[i][j][0][9] + V3[10]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][0] = H[i][j][1][0] - (x/d)*V3[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][1] = H[i][j][1][1] + ((x/d)*(x/d)*V3[1] + (1-(x/d)*(x/d))*V3[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][2] = H[i][j][1][2] + (x/d)*(y/d)*(V3[1] - V3[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][3] = H[i][j][1][3] + (x/d)*(z/d)*(V3[1] - V3[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][4] = H[i][j][1][4] + (1.732*(x/d)*(x/d)*(y/d)*V3[8]+(y/d)*(1-2*(x/d)*(x/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][5] = H[i][j][1][5] + (x/d)*(y/d)*(z/d)*(1.732*V3[8]-2.0*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][6] = H[i][j][1][6] + (1.732*(x/d)*(x/d)*(z/d)*V3[8]+(z/d)*(1-2*(x/d)*(x/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][7] = H[i][j][1][7] + (0.5*1.732*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[8]+
						(x/d)*(1-(x/d)*(x/d)+ (y/d)*(y/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][8] = H[i][j][1][8] + (x/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[8]
						-1.732*(x/d)*(z/d)*(z/d)*V3[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][9] = H[i][j][1][9] - (x/d)*V3[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][0] = H[i][j][2][0] - (y/d)*V3[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][1] = H[i][j][2][1] + (x/d)*(y/d)*(V3[1] - V3[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][2] = H[i][j][2][2] + ((y/d)*(y/d)*V3[1] + (1-(y/d)*(y/d))*V3[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][3] = H[i][j][2][3] + (y/d)*(z/d)*(V3[1] - V3[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][4] = H[i][j][2][4] + (1.732*(y/d)*(y/d)*(x/d)*V3[8]+(x/d)*(1-2*(y/d)*(y/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][5] = H[i][j][2][5] + (1.732*(y/d)*(y/d)*(z/d)*V3[8]+(z/d)*(1-2*(y/d)*(y/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][6] = H[i][j][2][6] + (y/d)*(z/d)*(x/d)*(1.732*V3[8]-2.0*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][7] = H[i][j][2][7] + 0.5*1.732*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[8]-
						(y/d)*(1+(x/d)*(x/d)-(y/d)*(y/d))*V3[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][8] = H[i][j][2][8] + (y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[8]-
						1.732*(y/d)*(z/d)*(z/d)*V3[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][9] = H[i][j][2][9] - (y/d)*V3[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][0] = H[i][j][3][1] - (z/d)*V3[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][1] = H[i][j][3][1] + (x/d)*(z/d)*(V3[1] - V3[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][2] = H[i][j][3][2] + (y/d)*(z/d)*(V3[1] - V3[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][3] = H[i][j][3][3] + ((z/d)*(z/d)*V3[1] + (1-(z/d)*(z/d))*V3[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][4] = H[i][j][3][4] + (x/d)*(y/d)*(z/d)*(1.732*V3[8]-2.0*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][5] = H[i][j][3][5] + (1.732*(z/d)*(z/d)*(y/d)*V3[8]+(y/d)*(1-2*(z/d)*(z/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][6] = H[i][j][3][6] + (1.732*(z/d)*(z/d)*(x/d)*V3[8]+(x/d)*(1-2*(z/d)*(z/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][7] = H[i][j][3][7] + (0.5*1.732*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[8]-
						(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][8] = H[i][j][3][8] + ((z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[8]+
						1.732*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][9] = H[i][j][3][9] - (z/d)*V3[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][0] = H[i][j][4][0] + 1.732*(x/d)*(y/d)*V3[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][1] = H[i][j][4][1] - (1.732*(x/d)*(x/d)*(y/d)*V3[8]+(y/d)*(1-2.0*(x/d)*(x/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][2] = H[i][j][4][2] - (1.732*(y/d)*(y/d)*(x/d)*V3[8]+(x/d)*(1-2.0*(y/d)*(y/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][3] = H[i][j][4][3] - (x/d)*(y/d)*(z/d)*(1.732*V3[8]-2.0*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][4] = H[i][j][4][4] + (3.0*(x/d)*(x/d)*(y/d)*(y/d)*V3[3]+((x/d)*(x/d)+(y/d)*(y/d)-4.0*(x/d)*(x/d)*(y/d)*(y/d))*V3[4]+
						((z/d)*(z/d)+(x/d)*(x/d)*(y/d)*(y/d))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][5] = H[i][j][4][5] + (3.0*(x/d)*(y/d)*(y/d)*(z/d)*V3[3]+(x/d)*(z/d)*(1-4*(y/d)*(y/d))*V3[4]+
						(x/d)*(z/d)*((y/d)*(y/d)-1)*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][6] = H[i][j][4][6] + (3*(x/d)*(x/d)*(y/d)*(z/d)*V3[3]+(y/d)*(z/d)*(1-4.0*(x/d)*(x/d))*V3[4]+
						(y/d)*(z/d)*((x/d)*(x/d)-1)*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][7] = H[i][j][4][7] + (1.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[3]+2.0*(x/d)*(y/d)*((y/d)*(y/d)-(x/d)*(x/d))*V3[4]+
						0.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][8] = H[i][j][4][8] + (1.732*(x/d)*(y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[3]+
						2.0*1.732*(x/d)*(y/d)*(z/d)*(z/d)*V3[4]+0.5*1.732*(x/d)*(y/d)*(1+(z/d)*(z/d))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][9] = H[i][j][4][9] + 1.732*(x/d)*(y/d)*V3[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][0] = H[i][j][5][0] + 1.732*(y/d)*(z/d)*V3[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][1] = H[i][j][5][1] - (x/d)*(y/d)*(z/d)*(1.732*V3[8]-2.0*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][2] = H[i][j][5][2] - (1.732*(y/d)*(y/d)*(z/d)*V3[8]+(z/d)*(1-2*(y/d)*(y/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][3] = H[i][j][5][3] - (1.732*(z/d)*(z/d)*(y/d)*V3[8]+(y/d)*(1-2*(z/d)*(z/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][4] = H[i][j][5][4] - (3.0*(x/d)*(y/d)*(y/d)*(z/d)*V3[3]+(x/d)*(z/d)*(1-4*(y/d)*(y/d))*V3[4]+
						(x/d)*(z/d)*((y/d)*(y/d)-1)*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][5] = H[i][j][5][5] + (3.0*(y/d)*(y/d)*(z/d)*(z/d)*V3[3]+((y/d)*(y/d)+(z/d)*(z/d)-4.0*(y/d)*(y/d)*(z/d)*(z/d))*V3[4]+
						((x/d)*(x/d)+(y/d)*(y/d)*(z/d)*(z/d))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][6] = H[i][j][5][6] + (3.0*(y/d)*(z/d)*(z/d)*(x/d)*V3[3]+(y/d)*(x/d)*(1-4*(z/d)*(z/d))*V3[4]+
						(y/d)*(x/d)*((z/d)*(z/d)-1)*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][7] = H[i][j][5][7] + (1.5*(y/d)*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[3]-
						(y/d)*(z/d)*(1+2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V3[4]+
						(y/d)*(z/d)*(1.0+0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][8] = H[i][j][5][8] + (1.732*(y/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[3]+
						1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V3[4]-
						0.5*1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][9] = H[i][j][5][9] + (1.732*(y/d)*(z/d)*V3[7])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][0] = H[i][j][6][0] + 1.732*(z/d)*(x/d)*V3[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][1] = H[i][j][6][1] - (1.732*(x/d)*(x/d)*(z/d)*V3[8]+(z/d)*(1-2*(x/d)*(x/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][2] = H[i][j][6][2] - (y/d)*(z/d)*(x/d)*(1.732*V3[8]-2.0*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][3] = H[i][j][6][3] - (1.732*(z/d)*(z/d)*(x/d)*V3[8]+(x/d)*(1-2*(z/d)*(z/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][4] = H[i][j][6][4] + (3*(x/d)*(x/d)*(y/d)*(z/d)*V3[3]+(y/d)*(z/d)*(1-4.0*(x/d)*(x/d))*V3[4]+
						(y/d)*(z/d)*((x/d)*(x/d)-1)*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][5] = H[i][j][6][5] + (3.0*(y/d)*(z/d)*(z/d)*(x/d)*V3[3]+(y/d)*(x/d)*(1-4*(z/d)*(z/d))*V3[4]+
						(y/d)*(x/d)*((z/d)*(z/d)-1)*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][6] = H[i][j][6][6] + (3.0*(z/d)*(z/d)*(x/d)*(x/d)*V3[3]+((z/d)*(z/d)+(x/d)*(x/d)-4.0*(z/d)*(z/d)*(x/d)*(x/d))*V3[4]+
						((y/d)*(y/d)+(z/d)*(z/d)*(x/d)*(x/d))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][7] = H[i][j][6][7] + (1.5*(z/d)*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[3]+
						(z/d)*(x/d)*(1.0-2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V3[4]-
						(z/d)*(x/d)*(1.0-0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][8] = H[i][j][6][8] + (1.732*(x/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[3]+
						1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V3[4]-
						0.5*1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][9] = H[i][j][6][9] + 1.732*(z/d)*(x/d)*V3[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][0] = H[i][j][7][0] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V3[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][1] = H[i][j][7][1] - (0.5*1.732*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[8]+
						(x/d)*(1-(x/d)*(x/d) + (y/d)*(y/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][2] = H[i][j][7][2] - 0.5*1.732*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[8]-
						(y/d)*(1+(x/d)*(x/d)-(y/d)*(y/d))*V3[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][3] = H[i][j][7][3] - (0.5*1.732*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[8]-
						(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][4] = H[i][j][7][4] + (1.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[3]+2.0*(x/d)*(y/d)*((y/d)*(y/d)-(x/d)*(x/d))*V3[4]+
						0.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][5] = H[i][j][7][5] + (1.5*(y/d)*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[3]-
						(y/d)*(z/d)*(1+2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V3[4]+
						(y/d)*(z/d)*(1.0+0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][6] = H[i][j][7][6] + (1.5*(z/d)*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V3[3]+
						(z/d)*(x/d)*(1.0-2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V3[4]-
						(z/d)*(x/d)*(1.0-0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][7] = H[i][j][7][7] + (0.75*((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d))*V3[3]+
						((x/d)*(x/d)+(y/d)*(y/d)-((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d)))*V3[4]+
						((z/d)*(z/d)+0.25*((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d)))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][8] = H[i][j][7][8] + (0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[3]+
						1.732*(z/d)*(z/d)*((y/d)*(y/d)-(x/d)*(x/d))*V3[4]+
						0.25*1.732*(1+(z/d)*(z/d))*((x/d)*(x/d)-(y/d)*(y/d))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][9] = H[i][j][7][9] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V3[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][0] = H[i][j][8][0] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][1] = H[i][j][8][1] - (x/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[8]
						-1.732*(x/d)*(z/d)*(z/d)*V3[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][2] = H[i][j][8][2] - (y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[8]-
						1.732*(y/d)*(z/d)*(z/d)*V3[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][3] = H[i][j][8][3] - ((z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[8]+
						1.732*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V3[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][4] = H[i][j][8][4] + (1.732*(x/d)*(y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[3]+
						2.0*1.732*(x/d)*(y/d)*(z/d)*(z/d)*V3[4]+0.5*1.732*(x/d)*(y/d)*(1+(z/d)*(z/d))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][5] = H[i][j][8][5] + (1.732*(y/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[3]+
						1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V3[4]-
						0.5*1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][6] = H[i][j][8][6] + (1.732*(x/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[3]+
						1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V3[4]-
						0.5*1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][7] = H[i][j][8][7] +  (0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[3]+
						1.732*(z/d)*(z/d)*((y/d)*(y/d)-(x/d)*(x/d))*V3[4]+
						0.25*1.732*(1+(z/d)*(z/d))*((x/d)*(x/d)-(y/d)*(y/d))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][8] = H[i][j][8][8] + (((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[3]+
						3.0*(z/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V3[4]+
						0.75*((x/d)*(x/d)+(y/d)*(y/d))*((x/d)*(x/d)+(y/d)*(y/d))*V3[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][9] = H[i][j][8][9] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][0] = H[i][j][9][0] + V3[10]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][1] = H[i][j][9][1] + (x/d)*V3[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][2] = H[i][j][9][2] + (y/d)*V3[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][3] = H[i][j][9][3] + (z/d)*V3[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][4] = H[i][j][9][4] + 1.732*(x/d)*(y/d)*V3[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][5] = H[i][j][9][5] + (1.732*(y/d)*(z/d)*V3[7])*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][6] = H[i][j][9][6] + 1.732*(z/d)*(x/d)*V3[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][7] = H[i][j][9][7] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V3[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][8] = H[i][j][9][8] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V3[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][9] = H[i][j][9][9] + V3[13]*exp(CI*kx*x)*x*2.68341;
				}
				if ((d > a4 - 0.001) && (d < a4 + 0.001))
				{
					H[i][j][0][0] = H[i][j][0][0] + V4[0]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][1] = H[i][j][0][1] + (x/d)*V4[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][2] = H[i][j][0][2] + (y/d)*V4[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][3] = H[i][j][0][3] + (z/d)*V4[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][4] = H[i][j][0][4] + 1.732*(x/d)*(y/d)*V4[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][5] = H[i][j][0][5] + 1.732*(y/d)*(z/d)*V4[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][6] = H[i][j][0][6] + 1.732*(z/d)*(x/d)*V4[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][7] = H[i][j][0][7] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V4[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][8] = H[i][j][0][8] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][9] = H[i][j][0][9] + V4[10]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][0] = H[i][j][1][0] - (x/d)*V4[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][1] = H[i][j][1][1] + ((x/d)*(x/d)*V4[1] + (1-(x/d)*(x/d))*V4[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][2] = H[i][j][1][2] + (x/d)*(y/d)*(V4[1] - V4[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][3] = H[i][j][1][3] + (x/d)*(z/d)*(V4[1] - V4[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][4] = H[i][j][1][4] + (1.732*(x/d)*(x/d)*(y/d)*V4[8]+(y/d)*(1-2*(x/d)*(x/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][5] = H[i][j][1][5] + (x/d)*(y/d)*(z/d)*(1.732*V4[8]-2.0*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][6] = H[i][j][1][6] + (1.732*(x/d)*(x/d)*(z/d)*V4[8]+(z/d)*(1-2*(x/d)*(x/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][7] = H[i][j][1][7] + (0.5*1.732*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[8]+
						(x/d)*(1-(x/d)*(x/d)+ (y/d)*(y/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][8] = H[i][j][1][8] + (x/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[8]
						-1.732*(x/d)*(z/d)*(z/d)*V4[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][9] = H[i][j][1][9] - (x/d)*V4[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][0] = H[i][j][2][0] - (y/d)*V4[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][1] = H[i][j][2][1] + (x/d)*(y/d)*(V4[1] - V4[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][2] = H[i][j][2][2] + ((y/d)*(y/d)*V4[1] + (1-(y/d)*(y/d))*V4[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][3] = H[i][j][2][3] + (y/d)*(z/d)*(V4[1] - V4[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][4] = H[i][j][2][4] + (1.732*(y/d)*(y/d)*(x/d)*V4[8]+(x/d)*(1-2*(y/d)*(y/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][5] = H[i][j][2][5] + (1.732*(y/d)*(y/d)*(z/d)*V4[8]+(z/d)*(1-2*(y/d)*(y/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][6] = H[i][j][2][6] + (y/d)*(z/d)*(x/d)*(1.732*V4[8]-2.0*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][7] = H[i][j][2][7] + 0.5*1.732*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[8]-
						(y/d)*(1+(x/d)*(x/d)-(y/d)*(y/d))*V4[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][8] = H[i][j][2][8] + (y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[8]-
						1.732*(y/d)*(z/d)*(z/d)*V4[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][9] = H[i][j][2][9] - (y/d)*V4[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][0] = H[i][j][3][1] - (z/d)*V4[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][1] = H[i][j][3][1] + (x/d)*(z/d)*(V4[1] - V4[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][2] = H[i][j][3][2] + (y/d)*(z/d)*(V4[1] - V4[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][3] = H[i][j][3][3] + ((z/d)*(z/d)*V4[1] + (1-(z/d)*(z/d))*V4[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][4] = H[i][j][3][4] + (x/d)*(y/d)*(z/d)*(1.732*V4[8]-2.0*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][5] = H[i][j][3][5] + (1.732*(z/d)*(z/d)*(y/d)*V4[8]+(y/d)*(1-2*(z/d)*(z/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][6] = H[i][j][3][6] + (1.732*(z/d)*(z/d)*(x/d)*V4[8]+(x/d)*(1-2*(z/d)*(z/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][7] = H[i][j][3][7] + (0.5*1.732*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[8]-
						(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][8] = H[i][j][3][8] + ((z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[8]+
						1.732*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][9] = H[i][j][3][9] - (z/d)*V4[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][0] = H[i][j][4][0] + 1.732*(x/d)*(y/d)*V4[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][1] = H[i][j][4][1] - (1.732*(x/d)*(x/d)*(y/d)*V4[8]+(y/d)*(1-2.0*(x/d)*(x/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][2] = H[i][j][4][2] - (1.732*(y/d)*(y/d)*(x/d)*V4[8]+(x/d)*(1-2.0*(y/d)*(y/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][3] = H[i][j][4][3] - (x/d)*(y/d)*(z/d)*(1.732*V4[8]-2.0*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][4] = H[i][j][4][4] + (3.0*(x/d)*(x/d)*(y/d)*(y/d)*V4[3]+((x/d)*(x/d)+(y/d)*(y/d)-4.0*(x/d)*(x/d)*(y/d)*(y/d))*V4[4]+
						((z/d)*(z/d)+(x/d)*(x/d)*(y/d)*(y/d))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][5] = H[i][j][4][5] + (3.0*(x/d)*(y/d)*(y/d)*(z/d)*V4[3]+(x/d)*(z/d)*(1-4*(y/d)*(y/d))*V4[4]+
						(x/d)*(z/d)*((y/d)*(y/d)-1)*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][6] = H[i][j][4][6] + (3*(x/d)*(x/d)*(y/d)*(z/d)*V4[3]+(y/d)*(z/d)*(1-4.0*(x/d)*(x/d))*V4[4]+
						(y/d)*(z/d)*((x/d)*(x/d)-1)*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][7] = H[i][j][4][7] + (1.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[3]+2.0*(x/d)*(y/d)*((y/d)*(y/d)-(x/d)*(x/d))*V4[4]+
						0.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][8] = H[i][j][4][8] + (1.732*(x/d)*(y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[3]+
						2.0*1.732*(x/d)*(y/d)*(z/d)*(z/d)*V4[4]+0.5*1.732*(x/d)*(y/d)*(1+(z/d)*(z/d))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][9] = H[i][j][4][9] + 1.732*(x/d)*(y/d)*V4[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][0] = H[i][j][5][0] + 1.732*(y/d)*(z/d)*V4[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][1] = H[i][j][5][1] - (x/d)*(y/d)*(z/d)*(1.732*V4[8]-2.0*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][2] = H[i][j][5][2] - (1.732*(y/d)*(y/d)*(z/d)*V4[8]+(z/d)*(1-2*(y/d)*(y/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][3] = H[i][j][5][3] - (1.732*(z/d)*(z/d)*(y/d)*V4[8]+(y/d)*(1-2*(z/d)*(z/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][4] = H[i][j][5][4] - (3.0*(x/d)*(y/d)*(y/d)*(z/d)*V4[3]+(x/d)*(z/d)*(1-4*(y/d)*(y/d))*V4[4]+
						(x/d)*(z/d)*((y/d)*(y/d)-1)*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][5] = H[i][j][5][5] + (3.0*(y/d)*(y/d)*(z/d)*(z/d)*V4[3]+((y/d)*(y/d)+(z/d)*(z/d)-4.0*(y/d)*(y/d)*(z/d)*(z/d))*V4[4]+
						((x/d)*(x/d)+(y/d)*(y/d)*(z/d)*(z/d))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][6] = H[i][j][5][6] + (3.0*(y/d)*(z/d)*(z/d)*(x/d)*V4[3]+(y/d)*(x/d)*(1-4*(z/d)*(z/d))*V4[4]+
						(y/d)*(x/d)*((z/d)*(z/d)-1)*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][7] = H[i][j][5][7] + (1.5*(y/d)*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[3]-
						(y/d)*(z/d)*(1+2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V4[4]+
						(y/d)*(z/d)*(1.0+0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][8] = H[i][j][5][8] + (1.732*(y/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[3]+
						1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V4[4]-
						0.5*1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][9] = H[i][j][5][9] + (1.732*(y/d)*(z/d)*V4[7])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][0] = H[i][j][6][0] + 1.732*(z/d)*(x/d)*V4[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][1] = H[i][j][6][1] - (1.732*(x/d)*(x/d)*(z/d)*V4[8]+(z/d)*(1-2*(x/d)*(x/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][2] = H[i][j][6][2] - (y/d)*(z/d)*(x/d)*(1.732*V4[8]-2.0*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][3] = H[i][j][6][3] - (1.732*(z/d)*(z/d)*(x/d)*V4[8]+(x/d)*(1-2*(z/d)*(z/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][4] = H[i][j][6][4] + (3*(x/d)*(x/d)*(y/d)*(z/d)*V4[3]+(y/d)*(z/d)*(1-4.0*(x/d)*(x/d))*V4[4]+
						(y/d)*(z/d)*((x/d)*(x/d)-1)*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][5] = H[i][j][6][5] + (3.0*(y/d)*(z/d)*(z/d)*(x/d)*V4[3]+(y/d)*(x/d)*(1-4*(z/d)*(z/d))*V4[4]+
						(y/d)*(x/d)*((z/d)*(z/d)-1)*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][6] = H[i][j][6][6] + (3.0*(z/d)*(z/d)*(x/d)*(x/d)*V4[3]+((z/d)*(z/d)+(x/d)*(x/d)-4.0*(z/d)*(z/d)*(x/d)*(x/d))*V4[4]+
						((y/d)*(y/d)+(z/d)*(z/d)*(x/d)*(x/d))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][7] = H[i][j][6][7] + (1.5*(z/d)*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[3]+
						(z/d)*(x/d)*(1.0-2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V4[4]-
						(z/d)*(x/d)*(1.0-0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][8] = H[i][j][6][8] + (1.732*(x/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[3]+
						1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V4[4]-
						0.5*1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][9] = H[i][j][6][9] + 1.732*(z/d)*(x/d)*V4[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][0] = H[i][j][7][0] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V4[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][1] = H[i][j][7][1] - (0.5*1.732*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[8]+
						(x/d)*(1-(x/d)*(x/d) + (y/d)*(y/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][2] = H[i][j][7][2] - 0.5*1.732*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[8]-
						(y/d)*(1+(x/d)*(x/d)-(y/d)*(y/d))*V4[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][3] = H[i][j][7][3] - (0.5*1.732*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[8]-
						(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][4] = H[i][j][7][4] + (1.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[3]+2.0*(x/d)*(y/d)*((y/d)*(y/d)-(x/d)*(x/d))*V4[4]+
						0.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][5] = H[i][j][7][5] + (1.5*(y/d)*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[3]-
						(y/d)*(z/d)*(1+2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V4[4]+
						(y/d)*(z/d)*(1.0+0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][6] = H[i][j][7][6] + (1.5*(z/d)*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V4[3]+
						(z/d)*(x/d)*(1.0-2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V4[4]-
						(z/d)*(x/d)*(1.0-0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][7] = H[i][j][7][7] + (0.75*((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d))*V4[3]+
						((x/d)*(x/d)+(y/d)*(y/d)-((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d)))*V4[4]+
						((z/d)*(z/d)+0.25*((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d)))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][8] = H[i][j][7][8] + (0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[3]+
						1.732*(z/d)*(z/d)*((y/d)*(y/d)-(x/d)*(x/d))*V4[4]+
						0.25*1.732*(1+(z/d)*(z/d))*((x/d)*(x/d)-(y/d)*(y/d))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][9] = H[i][j][7][9] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V4[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][0] = H[i][j][8][0] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][1] = H[i][j][8][1] - (x/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[8]
						-1.732*(x/d)*(z/d)*(z/d)*V4[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][2] = H[i][j][8][2] - (y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[8]-
						1.732*(y/d)*(z/d)*(z/d)*V4[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][3] = H[i][j][8][3] - ((z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[8]+
						1.732*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V4[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][4] = H[i][j][8][4] + (1.732*(x/d)*(y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[3]+
						2.0*1.732*(x/d)*(y/d)*(z/d)*(z/d)*V4[4]+0.5*1.732*(x/d)*(y/d)*(1+(z/d)*(z/d))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][5] = H[i][j][8][5] + (1.732*(y/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[3]+
						1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V4[4]-
						0.5*1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][6] = H[i][j][8][6] + (1.732*(x/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[3]+
						1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V4[4]-
						0.5*1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][7] = H[i][j][8][7] +  (0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[3]+
						1.732*(z/d)*(z/d)*((y/d)*(y/d)-(x/d)*(x/d))*V4[4]+
						0.25*1.732*(1+(z/d)*(z/d))*((x/d)*(x/d)-(y/d)*(y/d))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][8] = H[i][j][8][8] + (((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[3]+
						3.0*(z/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V4[4]+
						0.75*((x/d)*(x/d)+(y/d)*(y/d))*((x/d)*(x/d)+(y/d)*(y/d))*V4[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][9] = H[i][j][8][9] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][0] = H[i][j][9][0] + V4[10]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][1] = H[i][j][9][1] + (x/d)*V4[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][2] = H[i][j][9][2] + (y/d)*V4[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][3] = H[i][j][9][3] + (z/d)*V4[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][4] = H[i][j][9][4] + 1.732*(x/d)*(y/d)*V4[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][5] = H[i][j][9][5] + (1.732*(y/d)*(z/d)*V4[7])*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][6] = H[i][j][9][6] + 1.732*(z/d)*(x/d)*V4[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][7] = H[i][j][9][7] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V4[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][8] = H[i][j][9][8] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V4[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][9] = H[i][j][9][9] + V4[13]*exp(CI*kx*x)*x*2.68341;
				}
				if ((d > a5 - 0.001) && (d < a5 + 0.001))
				{
					H[i][j][0][0] = H[i][j][0][0] + V5[0]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][1] = H[i][j][0][1] + (x/d)*V5[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][2] = H[i][j][0][2] + (y/d)*V5[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][3] = H[i][j][0][3] + (z/d)*V5[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][4] = H[i][j][0][4] + 1.732*(x/d)*(y/d)*V5[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][5] = H[i][j][0][5] + 1.732*(y/d)*(z/d)*V5[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][6] = H[i][j][0][6] + 1.732*(z/d)*(x/d)*V5[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][7] = H[i][j][0][7] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V5[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][8] = H[i][j][0][8] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][0][9] = H[i][j][0][9] + V5[10]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][0] = H[i][j][1][0] - (x/d)*V5[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][1] = H[i][j][1][1] + ((x/d)*(x/d)*V5[1] + (1-(x/d)*(x/d))*V5[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][2] = H[i][j][1][2] + (x/d)*(y/d)*(V5[1] - V5[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][3] = H[i][j][1][3] + (x/d)*(z/d)*(V5[1] - V5[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][4] = H[i][j][1][4] + (1.732*(x/d)*(x/d)*(y/d)*V5[8]+(y/d)*(1-2*(x/d)*(x/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][5] = H[i][j][1][5] + (x/d)*(y/d)*(z/d)*(1.732*V5[8]-2.0*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][6] = H[i][j][1][6] + (1.732*(x/d)*(x/d)*(z/d)*V5[8]+(z/d)*(1-2*(x/d)*(x/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][7] = H[i][j][1][7] + (0.5*1.732*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[8]+
						(x/d)*(1-(x/d)*(x/d)+ (y/d)*(y/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][8] = H[i][j][1][8] + (x/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[8]
						-1.732*(x/d)*(z/d)*(z/d)*V5[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][1][9] = H[i][j][1][9] - (x/d)*V5[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][0] = H[i][j][2][0] - (y/d)*V5[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][1] = H[i][j][2][1] + (x/d)*(y/d)*(V5[1] - V5[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][2] = H[i][j][2][2] + ((y/d)*(y/d)*V5[1] + (1-(y/d)*(y/d))*V5[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][3] = H[i][j][2][3] + (y/d)*(z/d)*(V5[1] - V5[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][4] = H[i][j][2][4] + (1.732*(y/d)*(y/d)*(x/d)*V5[8]+(x/d)*(1-2*(y/d)*(y/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][5] = H[i][j][2][5] + (1.732*(y/d)*(y/d)*(z/d)*V5[8]+(z/d)*(1-2*(y/d)*(y/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][6] = H[i][j][2][6] + (y/d)*(z/d)*(x/d)*(1.732*V5[8]-2.0*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][7] = H[i][j][2][7] + 0.5*1.732*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[8]-
						(y/d)*(1+(x/d)*(x/d)-(y/d)*(y/d))*V5[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][8] = H[i][j][2][8] + (y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[8]-
						1.732*(y/d)*(z/d)*(z/d)*V5[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][2][9] = H[i][j][2][9] - (y/d)*V5[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][0] = H[i][j][3][1] - (z/d)*V5[6]*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][1] = H[i][j][3][1] + (x/d)*(z/d)*(V5[1] - V5[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][2] = H[i][j][3][2] + (y/d)*(z/d)*(V5[1] - V5[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][3] = H[i][j][3][3] + ((z/d)*(z/d)*V5[1] + (1-(z/d)*(z/d))*V5[2])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][4] = H[i][j][3][4] + (x/d)*(y/d)*(z/d)*(1.732*V5[8]-2.0*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][5] = H[i][j][3][5] + (1.732*(z/d)*(z/d)*(y/d)*V5[8]+(y/d)*(1-2*(z/d)*(z/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][6] = H[i][j][3][6] + (1.732*(z/d)*(z/d)*(x/d)*V5[8]+(x/d)*(1-2*(z/d)*(z/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][7] = H[i][j][3][7] + (0.5*1.732*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[8]-
						(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][8] = H[i][j][3][8] + ((z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[8]+
						1.732*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][3][9] = H[i][j][3][9] - (z/d)*V5[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][0] = H[i][j][4][0] + 1.732*(x/d)*(y/d)*V5[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][1] = H[i][j][4][1] - (1.732*(x/d)*(x/d)*(y/d)*V5[8]+(y/d)*(1-2.0*(x/d)*(x/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][2] = H[i][j][4][2] - (1.732*(y/d)*(y/d)*(x/d)*V5[8]+(x/d)*(1-2.0*(y/d)*(y/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][3] = H[i][j][4][3] - (x/d)*(y/d)*(z/d)*(1.732*V5[8]-2.0*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][4] = H[i][j][4][4] + (3.0*(x/d)*(x/d)*(y/d)*(y/d)*V5[3]+((x/d)*(x/d)+(y/d)*(y/d)-4.0*(x/d)*(x/d)*(y/d)*(y/d))*V5[4]+
						((z/d)*(z/d)+(x/d)*(x/d)*(y/d)*(y/d))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][5] = H[i][j][4][5] + (3.0*(x/d)*(y/d)*(y/d)*(z/d)*V5[3]+(x/d)*(z/d)*(1-4*(y/d)*(y/d))*V5[4]+
						(x/d)*(z/d)*((y/d)*(y/d)-1)*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][6] = H[i][j][4][6] + (3*(x/d)*(x/d)*(y/d)*(z/d)*V5[3]+(y/d)*(z/d)*(1-4.0*(x/d)*(x/d))*V5[4]+
						(y/d)*(z/d)*((x/d)*(x/d)-1)*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][7] = H[i][j][4][7] + (1.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[3]+2.0*(x/d)*(y/d)*((y/d)*(y/d)-(x/d)*(x/d))*V5[4]+
						0.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][8] = H[i][j][4][8] + (1.732*(x/d)*(y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[3]+
						2.0*1.732*(x/d)*(y/d)*(z/d)*(z/d)*V5[4]+0.5*1.732*(x/d)*(y/d)*(1+(z/d)*(z/d))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][4][9] = H[i][j][4][9] + 1.732*(x/d)*(y/d)*V5[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][0] = H[i][j][5][0] + 1.732*(y/d)*(z/d)*V5[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][1] = H[i][j][5][1] - (x/d)*(y/d)*(z/d)*(1.732*V5[8]-2.0*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][2] = H[i][j][5][2] - (1.732*(y/d)*(y/d)*(z/d)*V5[8]+(z/d)*(1-2*(y/d)*(y/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][3] = H[i][j][5][3] - (1.732*(z/d)*(z/d)*(y/d)*V5[8]+(y/d)*(1-2*(z/d)*(z/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][4] = H[i][j][5][4] - (3.0*(x/d)*(y/d)*(y/d)*(z/d)*V5[3]+(x/d)*(z/d)*(1-4*(y/d)*(y/d))*V5[4]+
						(x/d)*(z/d)*((y/d)*(y/d)-1)*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][5] = H[i][j][5][5] + (3.0*(y/d)*(y/d)*(z/d)*(z/d)*V5[3]+((y/d)*(y/d)+(z/d)*(z/d)-4.0*(y/d)*(y/d)*(z/d)*(z/d))*V5[4]+
						((x/d)*(x/d)+(y/d)*(y/d)*(z/d)*(z/d))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][6] = H[i][j][5][6] + (3.0*(y/d)*(z/d)*(z/d)*(x/d)*V5[3]+(y/d)*(x/d)*(1-4*(z/d)*(z/d))*V5[4]+
						(y/d)*(x/d)*((z/d)*(z/d)-1)*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][7] = H[i][j][5][7] + (1.5*(y/d)*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[3]-
						(y/d)*(z/d)*(1+2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V5[4]+
						(y/d)*(z/d)*(1.0+0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][8] = H[i][j][5][8] + (1.732*(y/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[3]+
						1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V5[4]-
						0.5*1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][5][9] = H[i][j][5][9] + (1.732*(y/d)*(z/d)*V5[7])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][0] = H[i][j][6][0] + 1.732*(z/d)*(x/d)*V5[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][1] = H[i][j][6][1] - (1.732*(x/d)*(x/d)*(z/d)*V5[8]+(z/d)*(1-2*(x/d)*(x/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][2] = H[i][j][6][2] - (y/d)*(z/d)*(x/d)*(1.732*V5[8]-2.0*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][3] = H[i][j][6][3] - (1.732*(z/d)*(z/d)*(x/d)*V5[8]+(x/d)*(1-2*(z/d)*(z/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][4] = H[i][j][6][4] + (3*(x/d)*(x/d)*(y/d)*(z/d)*V5[3]+(y/d)*(z/d)*(1-4.0*(x/d)*(x/d))*V5[4]+
						(y/d)*(z/d)*((x/d)*(x/d)-1)*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][5] = H[i][j][6][5] + (3.0*(y/d)*(z/d)*(z/d)*(x/d)*V5[3]+(y/d)*(x/d)*(1-4*(z/d)*(z/d))*V5[4]+
						(y/d)*(x/d)*((z/d)*(z/d)-1)*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][6] = H[i][j][6][6] + (3.0*(z/d)*(z/d)*(x/d)*(x/d)*V5[3]+((z/d)*(z/d)+(x/d)*(x/d)-4.0*(z/d)*(z/d)*(x/d)*(x/d))*V5[4]+
						((y/d)*(y/d)+(z/d)*(z/d)*(x/d)*(x/d))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][7] = H[i][j][6][7] + (1.5*(z/d)*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[3]+
						(z/d)*(x/d)*(1.0-2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V5[4]-
						(z/d)*(x/d)*(1.0-0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][8] = H[i][j][6][8] + (1.732*(x/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[3]+
						1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V5[4]-
						0.5*1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][6][9] = H[i][j][6][9] + 1.732*(z/d)*(x/d)*V5[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][0] = H[i][j][7][0] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V5[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][1] = H[i][j][7][1] - (0.5*1.732*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[8]+
						(x/d)*(1-(x/d)*(x/d) + (y/d)*(y/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][2] = H[i][j][7][2] - 0.5*1.732*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[8]-
						(y/d)*(1+(x/d)*(x/d)-(y/d)*(y/d))*V5[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][3] = H[i][j][7][3] - (0.5*1.732*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[8]-
						(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][4] = H[i][j][7][4] + (1.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[3]+2.0*(x/d)*(y/d)*((y/d)*(y/d)-(x/d)*(x/d))*V5[4]+
						0.5*(x/d)*(y/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][5] = H[i][j][7][5] + (1.5*(y/d)*(z/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[3]-
						(y/d)*(z/d)*(1+2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V5[4]+
						(y/d)*(z/d)*(1.0+0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][6] = H[i][j][7][6] + (1.5*(z/d)*(x/d)*((x/d)*(x/d)-(y/d)*(y/d))*V5[3]+
						(z/d)*(x/d)*(1.0-2.0*((x/d)*(x/d)-(y/d)*(y/d)))*V5[4]-
						(z/d)*(x/d)*(1.0-0.5*((x/d)*(x/d)-(y/d)*(y/d)))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][7] = H[i][j][7][7] + (0.75*((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d))*V5[3]+
						((x/d)*(x/d)+(y/d)*(y/d)-((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d)))*V5[4]+
						((z/d)*(z/d)+0.25*((x/d)*(x/d)-(y/d)*(y/d))*((x/d)*(x/d)-(y/d)*(y/d)))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][8] = H[i][j][7][8] + (0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[3]+
						1.732*(z/d)*(z/d)*((y/d)*(y/d)-(x/d)*(x/d))*V5[4]+
						0.25*1.732*(1+(z/d)*(z/d))*((x/d)*(x/d)-(y/d)*(y/d))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][7][9] = H[i][j][7][9] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V5[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][0] = H[i][j][8][0] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[7]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][1] = H[i][j][8][1] - (x/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[8]
						-1.732*(x/d)*(z/d)*(z/d)*V5[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][2] = H[i][j][8][2] - (y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[8]-
						1.732*(y/d)*(z/d)*(z/d)*V5[9]*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][3] = H[i][j][8][3] - ((z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[8]+
						1.732*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V5[9])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][4] = H[i][j][8][4] + (1.732*(x/d)*(y/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[3]+
						2.0*1.732*(x/d)*(y/d)*(z/d)*(z/d)*V5[4]+0.5*1.732*(x/d)*(y/d)*(1+(z/d)*(z/d))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][5] = H[i][j][8][5] + (1.732*(y/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[3]+
						1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V5[4]-
						0.5*1.732*(y/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][6] = H[i][j][8][6] + (1.732*(x/d)*(z/d)*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[3]+
						1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d)-(z/d)*(z/d))*V5[4]-
						0.5*1.732*(x/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][7] = H[i][j][8][7] +  (0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[3]+
						1.732*(z/d)*(z/d)*((y/d)*(y/d)-(x/d)*(x/d))*V5[4]+
						0.25*1.732*(1+(z/d)*(z/d))*((x/d)*(x/d)-(y/d)*(y/d))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][8] = H[i][j][8][8] + (((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[3]+
						3.0*(z/d)*(z/d)*((x/d)*(x/d)+(y/d)*(y/d))*V5[4]+
						0.75*((x/d)*(x/d)+(y/d)*(y/d))*((x/d)*(x/d)+(y/d)*(y/d))*V5[5])*exp(CI*kx*x)*x*2.68341;
					H[i][j][8][9] = H[i][j][8][9] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][0] = H[i][j][9][0] + V5[10]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][1] = H[i][j][9][1] + (x/d)*V5[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][2] = H[i][j][9][2] + (y/d)*V5[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][3] = H[i][j][9][3] + (z/d)*V5[11]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][4] = H[i][j][9][4] + 1.732*(x/d)*(y/d)*V5[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][5] = H[i][j][9][5] + (1.732*(y/d)*(z/d)*V5[7])*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][6] = H[i][j][9][6] + 1.732*(z/d)*(x/d)*V5[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][7] = H[i][j][9][7] + 0.5*1.732*((x/d)*(x/d)-(y/d)*(y/d))*V5[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][8] = H[i][j][9][8] + ((z/d)*(z/d)-0.5*((x/d)*(x/d)+(y/d)*(y/d)))*V5[12]*exp(CI*kx*x)*x*2.68341;
					H[i][j][9][9] = H[i][j][9][9] + V5[13]*exp(CI*kx*x)*x*2.68341;
				}
				if (d == 0)
				{
					H[i][j][0][0] = V[0];
					H[i][j][0][1] = 0.0;
					H[i][j][0][2] = 0.0;
					H[i][j][0][3] = 0.0;
					H[i][j][0][4] = 0.0;
					H[i][j][0][5] = 0.0;
					H[i][j][0][6] = 0.0;
					H[i][j][0][7] = 0.0;
					H[i][j][0][8] = 0.0;
					H[i][j][0][9] = 0.0;
					H[i][j][1][0] = 0.0;
					H[i][j][1][1] = V[1];
					H[i][j][1][2] = 0.0;
					H[i][j][1][3] = 0.0;
					H[i][j][1][4] = 0.0;
					H[i][j][1][5] = 0.0;
					H[i][j][1][6] = 0.0;
					H[i][j][1][7] = 0.0;
					H[i][j][1][8] = 0.0;
					H[i][j][1][9] = 0.0;
					H[i][j][2][0] = 0.0;
					H[i][j][2][1] = 0.0;
					H[i][j][2][2] = V[1];
					H[i][j][2][3] = 0.0;
					H[i][j][2][4] = 0.0;
					H[i][j][2][5] = 0.0;
					H[i][j][2][6] = 0.0;
					H[i][j][2][7] = 0.0;
					H[i][j][2][8] = 0.0;
					H[i][j][2][9] = 0.0;
					H[i][j][3][0] = 0.0;
					H[i][j][3][1] = 0.0;
					H[i][j][3][2] = 0.0;
					H[i][j][3][3] = V[1];
					H[i][j][3][4] = 0.0;
					H[i][j][3][5] = 0.0;
					H[i][j][3][6] = 0.0;
					H[i][j][3][7] = 0.0;
					H[i][j][3][8] = 0.0;
					H[i][j][3][9] = 0.0;
					H[i][j][4][0] = 0.0;
					H[i][j][4][1] = 0.0;
					H[i][j][4][2] = 0.0;
					H[i][j][4][3] = 0.0;
					H[i][j][4][4] = 0.0;
					H[i][j][4][5] = 0.0;
					H[i][j][4][6] = 0.0;
					H[i][j][4][7] = 0.0;
					H[i][j][4][8] = 0.0;
					H[i][j][4][9] = 0.0;
					H[i][j][5][0] = 0.0;
					H[i][j][5][1] = 0.0;
					H[i][j][5][2] = 0.0;
					H[i][j][5][3] = 0.0;
					H[i][j][5][4] = 0.0;
					H[i][j][5][5] = 0.0;
					H[i][j][5][6] = 0.0;
					H[i][j][5][7] = 0.0;
					H[i][j][5][8] = 0.0;
					H[i][j][5][9] = 0.0;
					H[i][j][6][0] = 0.0;
					H[i][j][6][1] = 0.0;
					H[i][j][6][2] = 0.0;
					H[i][j][6][3] = 0.0;
					H[i][j][6][4] = 0.0;
					H[i][j][6][5] = 0.0;
					H[i][j][6][6] = 0.0;
					H[i][j][6][7] = 0.0;
					H[i][j][6][8] = 0.0;
					H[i][j][6][9] = 0.0;
					H[i][j][7][0] = 0.0;
					H[i][j][7][1] = 0.0;
					H[i][j][7][2] = 0.0;
					H[i][j][7][3] = 0.0;
					H[i][j][7][4] = 0.0;
					H[i][j][7][5] = 0.0;
					H[i][j][7][6] = 0.0;
					H[i][j][7][7] = 0.0;
					H[i][j][7][8] = 0.0;
					H[i][j][7][9] = 0.0;
					H[i][j][8][0] = 0.0;
					H[i][j][8][1] = 0.0;
					H[i][j][8][2] = 0.0;
					H[i][j][8][3] = 0.0;
					H[i][j][8][4] = 0.0;
					H[i][j][8][5] = 0.0;
					H[i][j][8][6] = 0.0;
					H[i][j][8][7] = 0.0;
					H[i][j][8][8] = 0.0;
					H[i][j][8][9] = 0.0;
					H[i][j][9][0] = 0.0;
					H[i][j][9][1] = 0.0;
					H[i][j][9][2] = 0.0;
					H[i][j][9][3] = 0.0;
					H[i][j][9][4] = 0.0;
					H[i][j][9][5] = 0.0;
					H[i][j][9][6] = 0.0;
					H[i][j][9][7] = 0.0;
					H[i][j][9][8] = 0.0;
					H[i][j][9][9] = 0.0;
				}
			}
		}
	}
}